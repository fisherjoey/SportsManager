<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: services/EncryptionService.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: services/EncryptionService.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const crypto = require('crypto');
const knex = require('../config/database');
const { v4: uuidv4 } = require('uuid');

/**
 * Enterprise-grade encryption service for sensitive data protection
 * Handles field-level encryption, key management, and secure data operations
 */
class EncryptionService {
  constructor() {
    this.algorithm = 'aes-256-gcm';
    this.keyLength = 32; // 256 bits
    this.ivLength = 16;  // 128 bits
    this.tagLength = 16; // 128 bits
    this.saltLength = 32; // 256 bits
    
    // Master encryption key from environment
    this.masterKey = this.deriveMasterKey();
    
    // Cache for derived keys (in production, use Redis or similar)
    this.keyCache = new Map();
  }

  /**
   * Derive master key from environment variable
   */
  deriveMasterKey() {
    const secret = process.env.ENCRYPTION_MASTER_KEY || process.env.JWT_SECRET;
    if (!secret || secret.length &lt; 32) {
      throw new Error('ENCRYPTION_MASTER_KEY must be at least 32 characters long');
    }
    
    // Use PBKDF2 to derive a consistent key from the secret
    const salt = 'sports-management-encryption-salt';
    return crypto.pbkdf2Sync(secret, salt, 100000, this.keyLength, 'sha512');
  }

  /**
   * Generate a new encryption key for a specific context
   */
  generateDataKey(context = 'default') {
    const keyId = uuidv4();
    const dataKey = crypto.randomBytes(this.keyLength);
    
    // Encrypt the data key with the master key
    const encryptedKey = this.encryptWithMasterKey(dataKey);
    
    // Cache the key (in production, store securely)
    this.keyCache.set(keyId, dataKey);
    
    return {
      keyId,
      encryptedKey: encryptedKey.toString('base64'),
      context
    };
  }

  /**
   * Encrypt data with master key
   */
  encryptWithMasterKey(data) {
    const iv = crypto.randomBytes(this.ivLength);
    const cipher = crypto.createCipher(this.algorithm, this.masterKey, { iv });
    
    let encrypted = cipher.update(data);
    encrypted = Buffer.concat([encrypted, cipher.final()]);
    
    const tag = cipher.getAuthTag();
    
    // Combine IV, tag, and encrypted data
    return Buffer.concat([iv, tag, encrypted]);
  }

  /**
   * Decrypt data with master key
   */
  decryptWithMasterKey(encryptedData) {
    const iv = encryptedData.slice(0, this.ivLength);
    const tag = encryptedData.slice(this.ivLength, this.ivLength + this.tagLength);
    const encrypted = encryptedData.slice(this.ivLength + this.tagLength);
    
    const decipher = crypto.createDecipher(this.algorithm, this.masterKey, { iv });
    decipher.setAuthTag(tag);
    
    let decrypted = decipher.update(encrypted);
    decrypted = Buffer.concat([decrypted, decipher.final()]);
    
    return decrypted;
  }

  /**
   * Encrypt sensitive field data
   */
  async encryptField(tableName, fieldName, recordId, plaintext) {
    try {
      if (!plaintext || plaintext === '') {
        return null;
      }

      // Generate or retrieve data key for this table/field combination
      const context = `${tableName}.${fieldName}`;
      let keyInfo = await this.getOrCreateDataKey(context);
      
      // Get the actual encryption key
      const dataKey = await this.getDataKey(keyInfo.keyId);
      if (!dataKey) {
        throw new Error('Failed to retrieve encryption key');
      }

      // Encrypt the data
      const iv = crypto.randomBytes(this.ivLength);
      const cipher = crypto.createCipher(this.algorithm, dataKey, { iv });
      
      let encrypted = cipher.update(Buffer.from(plaintext, 'utf8'));
      encrypted = Buffer.concat([encrypted, cipher.final()]);
      
      const tag = cipher.getAuthTag();
      
      // Combine IV, tag, and encrypted data
      const encryptedBuffer = Buffer.concat([iv, tag, encrypted]);
      const encryptedValue = encryptedBuffer.toString('base64');

      // Store in encrypted_fields table
      await knex('encrypted_fields')
        .insert({
          id: uuidv4(),
          table_name: tableName,
          field_name: fieldName,
          record_id: recordId.toString(),
          encrypted_value: encryptedValue,
          encryption_key_id: keyInfo.keyId,
          created_at: new Date(),
          updated_at: new Date()
        })
        .onConflict(['table_name', 'field_name', 'record_id'])
        .merge({
          encrypted_value: encryptedValue,
          encryption_key_id: keyInfo.keyId,
          updated_at: new Date()
        });

      return {
        encrypted: true,
        keyId: keyInfo.keyId,
        fieldId: `${tableName}.${fieldName}.${recordId}`
      };

    } catch (error) {
      console.error('Encryption error:', error);
      throw new Error('Failed to encrypt field data');
    }
  }

  /**
   * Decrypt sensitive field data
   */
  async decryptField(tableName, fieldName, recordId) {
    try {
      // Retrieve encrypted data
      const encryptedField = await knex('encrypted_fields')
        .where({
          table_name: tableName,
          field_name: fieldName,
          record_id: recordId.toString()
        })
        .first();

      if (!encryptedField) {
        return null;
      }

      // Get the encryption key
      const dataKey = await this.getDataKey(encryptedField.encryption_key_id);
      if (!dataKey) {
        throw new Error('Failed to retrieve decryption key');
      }

      // Decrypt the data
      const encryptedBuffer = Buffer.from(encryptedField.encrypted_value, 'base64');
      
      const iv = encryptedBuffer.slice(0, this.ivLength);
      const tag = encryptedBuffer.slice(this.ivLength, this.ivLength + this.tagLength);
      const encrypted = encryptedBuffer.slice(this.ivLength + this.tagLength);
      
      const decipher = crypto.createDecipher(this.algorithm, dataKey, { iv });
      decipher.setAuthTag(tag);
      
      let decrypted = decipher.update(encrypted);
      decrypted = Buffer.concat([decrypted, decipher.final()]);
      
      return decrypted.toString('utf8');

    } catch (error) {
      console.error('Decryption error:', error);
      throw new Error('Failed to decrypt field data');
    }
  }

  /**
   * Encrypt multiple fields for a record
   */
  async encryptFields(tableName, recordId, fields) {
    const results = {};
    
    for (const [fieldName, value] of Object.entries(fields)) {
      if (value !== null &amp;&amp; value !== undefined &amp;&amp; value !== '') {
        results[fieldName] = await this.encryptField(tableName, fieldName, recordId, value);
      } else {
        results[fieldName] = null;
      }
    }
    
    return results;
  }

  /**
   * Decrypt multiple fields for a record
   */
  async decryptFields(tableName, recordId, fieldNames) {
    const results = {};
    
    for (const fieldName of fieldNames) {
      results[fieldName] = await this.decryptField(tableName, fieldName, recordId);
    }
    
    return results;
  }

  /**
   * Get or create data key for a context
   */
  async getOrCreateDataKey(context) {
    // In production, this would check a secure key store
    // For now, generate a new key each time
    return this.generateDataKey(context);
  }

  /**
   * Retrieve data key by ID
   */
  async getDataKey(keyId) {
    // Check cache first
    if (this.keyCache.has(keyId)) {
      return this.keyCache.get(keyId);
    }

    // In production, this would retrieve from secure key store
    // For now, generate a deterministic key based on keyId and master key
    const keyMaterial = crypto
      .createHmac('sha256', this.masterKey)
      .update(keyId)
      .digest();

    // Cache the key
    this.keyCache.set(keyId, keyMaterial);
    
    return keyMaterial;
  }

  /**
   * Hash sensitive data (one-way)
   */
  hashData(data, salt = null) {
    if (!salt) {
      salt = crypto.randomBytes(this.saltLength);
    }
    
    const hash = crypto.pbkdf2Sync(data, salt, 100000, 64, 'sha512');
    
    return {
      hash: hash.toString('hex'),
      salt: salt.toString('hex')
    };
  }

  /**
   * Verify hashed data
   */
  verifyHash(data, hash, salt) {
    const saltBuffer = Buffer.from(salt, 'hex');
    const hashedData = this.hashData(data, saltBuffer);
    
    return hashedData.hash === hash;
  }

  /**
   * Generate secure random token
   */
  generateToken(length = 32) {
    return crypto.randomBytes(length).toString('hex');
  }

  /**
   * Generate cryptographically secure random numbers
   */
  generateSecureRandom(min = 0, max = 1000000) {
    const range = max - min + 1;
    const bytesNeeded = Math.ceil(Math.log2(range) / 8);
    
    let randomValue;
    do {
      const randomBytes = crypto.randomBytes(bytesNeeded);
      randomValue = randomBytes.readUIntBE(0, bytesNeeded);
    } while (randomValue >= Math.floor(0x100 ** bytesNeeded / range) * range);
    
    return min + (randomValue % range);
  }

  /**
   * Encrypt file data
   */
  async encryptFile(fileBuffer, metadata = {}) {
    try {
      const keyInfo = this.generateDataKey('file_encryption');
      const dataKey = await this.getDataKey(keyInfo.keyId);
      
      const iv = crypto.randomBytes(this.ivLength);
      const cipher = crypto.createCipher(this.algorithm, dataKey, { iv });
      
      let encrypted = cipher.update(fileBuffer);
      encrypted = Buffer.concat([encrypted, cipher.final()]);
      
      const tag = cipher.getAuthTag();
      
      // Combine IV, tag, and encrypted data
      const encryptedBuffer = Buffer.concat([iv, tag, encrypted]);
      
      return {
        encryptedData: encryptedBuffer,
        keyId: keyInfo.keyId,
        metadata: {
          ...metadata,
          originalSize: fileBuffer.length,
          encryptedSize: encryptedBuffer.length,
          algorithm: this.algorithm
        }
      };

    } catch (error) {
      console.error('File encryption error:', error);
      throw new Error('Failed to encrypt file');
    }
  }

  /**
   * Decrypt file data
   */
  async decryptFile(encryptedBuffer, keyId) {
    try {
      const dataKey = await this.getDataKey(keyId);
      
      const iv = encryptedBuffer.slice(0, this.ivLength);
      const tag = encryptedBuffer.slice(this.ivLength, this.ivLength + this.tagLength);
      const encrypted = encryptedBuffer.slice(this.ivLength + this.tagLength);
      
      const decipher = crypto.createDecipher(this.algorithm, dataKey, { iv });
      decipher.setAuthTag(tag);
      
      let decrypted = decipher.update(encrypted);
      decrypted = Buffer.concat([decrypted, decipher.final()]);
      
      return decrypted;

    } catch (error) {
      console.error('File decryption error:', error);
      throw new Error('Failed to decrypt file');
    }
  }

  /**
   * Clean up expired encryption keys
   */
  async rotateKeys() {
    // Implementation for key rotation
    // This would be called periodically to rotate encryption keys
    console.log('Key rotation initiated');
    
    // In production, this would:
    // 1. Generate new keys
    // 2. Re-encrypt data with new keys
    // 3. Securely dispose of old keys
    // 4. Update key references
    
    return {
      rotated: 0,
      errors: 0
    };
  }

  /**
   * Get encryption statistics
   */
  async getEncryptionStats() {
    const stats = await knex('encrypted_fields')
      .select('table_name')
      .count('* as count')
      .groupBy('table_name');

    return {
      totalEncryptedFields: stats.reduce((sum, stat) => sum + parseInt(stat.count), 0),
      encryptedTables: stats,
      algorithm: this.algorithm,
      keyLength: this.keyLength
    };
  }

  /**
   * Validate encryption integrity
   */
  async validateIntegrity(tableName = null, fieldName = null) {
    let query = knex('encrypted_fields');
    
    if (tableName) {
      query = query.where('table_name', tableName);
    }
    
    if (fieldName) {
      query = query.where('field_name', fieldName);
    }

    const encryptedFields = await query.limit(100); // Process in batches
    
    let validCount = 0;
    let invalidCount = 0;
    const errors = [];

    for (const field of encryptedFields) {
      try {
        const decrypted = await this.decryptField(
          field.table_name,
          field.field_name,
          field.record_id
        );
        
        if (decrypted !== null) {
          validCount++;
        } else {
          invalidCount++;
        }
      } catch (error) {
        invalidCount++;
        errors.push({
          field: `${field.table_name}.${field.field_name}.${field.record_id}`,
          error: error.message
        });
      }
    }

    return {
      valid: validCount,
      invalid: invalidCount,
      errors: errors.slice(0, 10) // Return first 10 errors
    };
  }
}

module.exports = EncryptionService;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-routes_assignments.html">routes/assignments</a></li><li><a href="module-routes_games.html">routes/games</a></li></ul><h3>Classes</h3><ul><li><a href="AdvancedPerformanceMetrics.html">AdvancedPerformanceMetrics</a></li><li><a href="ApiError.html">ApiError</a></li><li><a href="AppError.html">AppError</a></li><li><a href="ApprovalWorkflowService.html">ApprovalWorkflowService</a></li><li><a href="AuthenticationError.html">AuthenticationError</a></li><li><a href="AuthorizationError.html">AuthorizationError</a></li><li><a href="global.html#BaseService">BaseService</a></li><li><a href="BudgetCalculationService.html">BudgetCalculationService</a></li><li><a href="BusinessLogicError.html">BusinessLogicError</a></li><li><a href="ConfigurationError.html">ConfigurationError</a></li><li><a href="ConflictError.html">ConflictError</a></li><li><a href="DatabaseError.html">DatabaseError</a></li><li><a href="DistanceCalculationService.html">DistanceCalculationService</a></li><li><a href="EncryptionService.html">EncryptionService</a></li><li><a href="ErrorFactory.html">ErrorFactory</a></li><li><a href="ErrorLogger.html">ErrorLogger</a></li><li><a href="ErrorMetrics.html">ErrorMetrics</a></li><li><a href="ErrorUtils.html">ErrorUtils</a></li><li><a href="ExternalServiceError.html">ExternalServiceError</a></li><li><a href="FileProcessingError.html">FileProcessingError</a></li><li><a href="FinancialAIService.html">FinancialAIService</a></li><li><a href="LocationDataService.html">LocationDataService</a></li><li><a href="MetricsCollector.html">MetricsCollector</a></li><li><a href="NotFoundError.html">NotFoundError</a></li><li><a href="PaymentMethodService.html">PaymentMethodService</a></li><li><a href="QueryBuilder.html">QueryBuilder</a></li><li><a href="QueryCache.html">QueryCache</a></li><li><a href="QueryPerformanceAnalyzer.html">QueryPerformanceAnalyzer</a></li><li><a href="RateLimitError.html">RateLimitError</a></li><li><a href="ResponseFormatter.html">ResponseFormatter</a></li><li><a href="SecurityService.html">SecurityService</a></li><li><a href="ServiceFactory.html">ServiceFactory</a></li><li><a href="TimeoutError.html">TimeoutError</a></li><li><a href="UnprocessableEntityError.html">UnprocessableEntityError</a></li><li><a href="ValidationError.html">ValidationError</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AUDIT_EVENTS">AUDIT_EVENTS</a></li><li><a href="global.html#AUDIT_SEVERITY">AUDIT_SEVERITY</a></li><li><a href="global.html#AssignmentSchemas">AssignmentSchemas</a></li><li><a href="global.html#AuthSchemas">AuthSchemas</a></li><li><a href="global.html#AvailabilitySchemas">AvailabilitySchemas</a></li><li><a href="global.html#BaseSchemas">BaseSchemas</a></li><li><a href="global.html#BudgetSchemas">BudgetSchemas</a></li><li><a href="global.html#COMMON_PATTERNS">COMMON_PATTERNS</a></li><li><a href="global.html#CUSTOM_VALIDATORS">CUSTOM_VALIDATORS</a></li><li><a href="global.html#CacheHelpers">CacheHelpers</a></li><li><a href="global.html#CacheInvalidation">CacheInvalidation</a></li><li><a href="global.html#ERROR_MESSAGES">ERROR_MESSAGES</a></li><li><a href="global.html#ERROR_SEVERITY">ERROR_SEVERITY</a></li><li><a href="global.html#ERROR_TYPES">ERROR_TYPES</a></li><li><a href="global.html#FileSchemas">FileSchemas</a></li><li><a href="global.html#FilterSchemas">FilterSchemas</a></li><li><a href="global.html#GameSchemas">GameSchemas</a></li><li><a href="global.html#HTTP_STATUS">HTTP_STATUS</a></li><li><a href="global.html#IdParamSchema">IdParamSchema</a></li><li><a href="global.html#NodeCache">NodeCache</a></li><li><a href="global.html#PaginationSchema">PaginationSchema</a></li><li><a href="global.html#QueryHelpers">QueryHelpers</a></li><li><a href="global.html#SCHEMA_REGISTRY">SCHEMA_REGISTRY</a></li><li><a href="global.html#UserSchemas">UserSchemas</a></li><li><a href="global.html#VALIDATION_OPTIONS">VALIDATION_OPTIONS</a></li><li><a href="global.html#addMinutes">addMinutes</a></li><li><a href="global.html#advancedPerformanceMonitor">advancedPerformanceMonitor</a></li><li><a href="global.html#asyncHandler">asyncHandler</a></li><li><a href="global.html#auditMiddleware">auditMiddleware</a></li><li><a href="global.html#authLimiter">authLimiter</a></li><li><a href="global.html#autoValidate">autoValidate</a></li><li><a href="global.html#calculateAvailabilityScore">calculateAvailabilityScore</a></li><li><a href="global.html#calculateDatabaseHealthScore">calculateDatabaseHealthScore</a></li><li><a href="global.html#calculateEndTime">calculateEndTime</a></li><li><a href="global.html#calculateFinalWage">calculateFinalWage</a></li><li><a href="global.html#checkAssignmentConflicts">checkAssignmentConflicts</a></li><li><a href="global.html#checkGameSchedulingConflicts">checkGameSchedulingConflicts</a></li><li><a href="global.html#checkRefereeDoubleBooking">checkRefereeDoubleBooking</a></li><li><a href="global.html#checkServiceHealth">checkServiceHealth</a></li><li><a href="global.html#checkTimeOverlap">checkTimeOverlap</a></li><li><a href="global.html#checkTravelTimeConflict">checkTravelTimeConflict</a></li><li><a href="global.html#checkVenueConflict">checkVenueConflict</a></li><li><a href="global.html#clearSettingsCache">clearSettingsCache</a></li><li><a href="global.html#conditionalValidation">conditionalValidation</a></li><li><a href="global.html#createAuditLog">createAuditLog</a></li><li><a href="global.html#createAuditLogsTable">createAuditLogsTable</a></li><li><a href="global.html#createPerformanceRoute">createPerformanceRoute</a></li><li><a href="global.html#createSecurityMiddleware">createSecurityMiddleware</a></li><li><a href="global.html#createTableService">createTableService</a></li><li><a href="global.html#createValidationError">createValidationError</a></li><li><a href="global.html#createValidator">createValidator</a></li><li><a href="global.html#db">db</a></li><li><a href="global.html#determineErrorSeverity">determineErrorSeverity</a></li><li><a href="global.html#determineEventType">determineEventType</a></li><li><a href="global.html#determineHealthStatus">determineHealthStatus</a></li><li><a href="global.html#determineIfShouldLog">determineIfShouldLog</a></li><li><a href="global.html#determineSeverity">determineSeverity</a></li><li><a href="global.html#enforceHTTPS">enforceHTTPS</a></li><li><a href="global.html#enhancedAsyncHandler">enhancedAsyncHandler</a></li><li><a href="global.html#errorHandler">errorHandler</a></li><li><a href="global.html#errorHealthCheck">errorHealthCheck</a></li><li><a href="global.html#express">express</a></li><li><a href="global.html#findAvailableReferees">findAvailableReferees</a></li><li><a href="global.html#formatAvailabilityResponse">formatAvailabilityResponse</a></li><li><a href="global.html#formatBytes">formatBytes</a></li><li><a href="global.html#generateAdvancedRecommendations">generateAdvancedRecommendations</a></li><li><a href="global.html#generateCacheRecommendations">generateCacheRecommendations</a></li><li><a href="global.html#generateDatabaseInsights">generateDatabaseInsights</a></li><li><a href="global.html#generateGroupStagePlayoffs">generateGroupStagePlayoffs</a></li><li><a href="global.html#generateHealthRecommendations">generateHealthRecommendations</a></li><li><a href="global.html#generateRecommendations">generateRecommendations</a></li><li><a href="global.html#generateRoundRobin">generateRoundRobin</a></li><li><a href="global.html#generateSingleElimination">generateSingleElimination</a></li><li><a href="global.html#generateSwissSystem">generateSwissSystem</a></li><li><a href="global.html#generateTransactionNumber">generateTransactionNumber</a></li><li><a href="global.html#getAdvancedMetrics">getAdvancedMetrics</a></li><li><a href="global.html#getAggregatedMetrics">getAggregatedMetrics</a></li><li><a href="global.html#getAuditEventType">getAuditEventType</a></li><li><a href="global.html#getClientIP">getClientIP</a></li><li><a href="global.html#getCorsConfig">getCorsConfig</a></li><li><a href="global.html#getErrorMessage">getErrorMessage</a></li><li><a href="global.html#getMetricsCollector">getMetricsCollector</a></li><li><a href="global.html#getMetricsEvents">getMetricsEvents</a></li><li><a href="global.html#getMetricsSummary">getMetricsSummary</a></li><li><a href="global.html#getMinutesBetween">getMinutesBetween</a></li><li><a href="global.html#getOrganizationSettings">getOrganizationSettings</a></li><li><a href="global.html#getPerformanceEvents">getPerformanceEvents</a></li><li><a href="global.html#getPerformanceStats">getPerformanceStats</a></li><li><a href="global.html#getQueryPerformanceEvents">getQueryPerformanceEvents</a></li><li><a href="global.html#getQueryPerformanceStats">getQueryPerformanceStats</a></li><li><a href="global.html#getSecurityConfig">getSecurityConfig</a></li><li><a href="global.html#getService">getService</a></li><li><a href="global.html#getServices">getServices</a></li><li><a href="global.html#getSlowQueriesSummary">getSlowQueriesSummary</a></li><li><a href="global.html#getWageBreakdown">getWageBreakdown</a></li><li><a href="global.html#handleApprovedRequest">handleApprovedRequest</a></li><li><a href="global.html#handleDatabaseError">handleDatabaseError</a></li><li><a href="global.html#hasSchedulingConflict">hasSchedulingConflict</a></li><li><a href="global.html#initializeServices">initializeServices</a></li><li><a href="global.html#knex">knex</a></li><li><a href="global.html#logError">logError</a></li><li><a href="global.html#logRequest">logRequest</a></li><li><a href="global.html#logSuspiciousActivity">logSuspiciousActivity</a></li><li><a href="global.html#logUnauthorizedCorsAttempt">logUnauthorizedCorsAttempt</a></li><li><a href="global.html#metricsEvents">metricsEvents</a></li><li><a href="global.html#notFoundHandler">notFoundHandler</a></li><li><a href="global.html#parseSize">parseSize</a></li><li><a href="global.html#parseSqlQuery">parseSqlQuery</a></li><li><a href="global.html#performanceEvents">performanceEvents</a></li><li><a href="global.html#performanceMonitor">performanceMonitor</a></li><li><a href="global.html#queryAuditLogs">queryAuditLogs</a></li><li><a href="global.html#queryCache">queryCache</a></li><li><a href="global.html#queryPerformanceEvents">queryPerformanceEvents</a></li><li><a href="global.html#queryValidationSchemas">queryValidationSchemas</a></li><li><a href="global.html#requestContextMiddleware">requestContextMiddleware</a></li><li><a href="global.html#requestContexts">requestContexts</a></li><li><a href="global.html#requestSizeLimit">requestSizeLimit</a></li><li><a href="global.html#resetAdvancedMetrics">resetAdvancedMetrics</a></li><li><a href="global.html#resetAllMetrics">resetAllMetrics</a></li><li><a href="global.html#resetPerformanceStats">resetPerformanceStats</a></li><li><a href="global.html#resetQueryPerformanceStats">resetQueryPerformanceStats</a></li><li><a href="global.html#sanitizeAll">sanitizeAll</a></li><li><a href="global.html#sanitizeBody">sanitizeBody</a></li><li><a href="global.html#sanitizeBodyForLogging">sanitizeBodyForLogging</a></li><li><a href="global.html#sanitizeError">sanitizeError</a></li><li><a href="global.html#sanitizeHeaders">sanitizeHeaders</a></li><li><a href="global.html#sanitizeInput">sanitizeInput</a></li><li><a href="global.html#sanitizeObject">sanitizeObject</a></li><li><a href="global.html#sanitizeParams">sanitizeParams</a></li><li><a href="global.html#sanitizeQuery">sanitizeQuery</a></li><li><a href="global.html#sanitizeString">sanitizeString</a></li><li><a href="global.html#securityConfig">securityConfig</a></li><li><a href="global.html#securityMonitoring">securityMonitoring</a></li><li><a href="global.html#sendAlertToWebhook">sendAlertToWebhook</a></li><li><a href="global.html#setupAlertHandlers">setupAlertHandlers</a></li><li><a href="global.html#setupGlobalErrorHandlers">setupGlobalErrorHandlers</a></li><li><a href="global.html#subtractMinutes">subtractMinutes</a></li><li><a href="global.html#testIntegrationConnection">testIntegrationConnection</a></li><li><a href="global.html#trackCacheOperation">trackCacheOperation</a></li><li><a href="global.html#trackDbQuery">trackDbQuery</a></li><li><a href="global.html#updateMetricsConfig">updateMetricsConfig</a></li><li><a href="global.html#validateAvailabilityWindow">validateAvailabilityWindow</a></li><li><a href="global.html#validateBody">validateBody</a></li><li><a href="global.html#validateContentType">validateContentType</a></li><li><a href="global.html#validateEnvironment">validateEnvironment</a></li><li><a href="global.html#validateFile">validateFile</a></li><li><a href="global.html#validateIdParam">validateIdParam</a></li><li><a href="global.html#validateParams">validateParams</a></li><li><a href="global.html#validateQuery">validateQuery</a></li><li><a href="global.html#validateRefereeQualifications">validateRefereeQualifications</a></li><li><a href="global.html#validateRequest">validateRequest</a></li><li><a href="global.html#validateUuidParam">validateUuidParam</a></li><li><a href="global.html#validationSummary">validationSummary</a></li><li><a href="global.html#withDatabaseError">withDatabaseError</a></li><li><a href="global.html#withErrorBoundary">withErrorBoundary</a></li><li><a href="global.html#withServiceTransaction">withServiceTransaction</a></li><li><a href="global.html#wrapDatabaseConnection">wrapDatabaseConnection</a></li><li><a href="global.html#wrapDatabaseQuery">wrapDatabaseQuery</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Fri Aug 01 2025 16:15:52 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
