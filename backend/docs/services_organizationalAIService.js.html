<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: services/organizationalAIService.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: services/organizationalAIService.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const { OpenAI } = require('openai');
const { Pool } = require('pg');

const pool = new Pool({
  connectionString: process.env.DATABASE_URL
});

// Initialize DeepSeek AI if API key is available
let openai = null;
if (process.env.DEEPSEEK_API_KEY) {
  openai = new OpenAI({
    apiKey: process.env.DEEPSEEK_API_KEY,
    baseURL: 'https://api.deepseek.com/v1'
  });
}

class OrganizationalAIService {
  /**
   * Analyze employee performance patterns and provide insights
   */
  static async analyzeEmployeePerformance(employeeId, options = {}) {
    try {
      // Get comprehensive employee data
      const employeeData = await this.getEmployeeAnalysisData(employeeId);
      
      if (!employeeData) {
        throw new Error('Employee not found');
      }

      const analysis = {
        employeeId,
        analysisDate: new Date(),
        insights: [],
        recommendations: [],
        riskFactors: [],
        strengths: []
      };

      // Analyze performance trends
      if (employeeData.evaluations.length >= 2) {
        const performanceTrend = this.analyzePerformanceTrend(employeeData.evaluations);
        analysis.insights.push({
          type: 'performance_trend',
          title: 'Performance Trend Analysis',
          content: performanceTrend.summary,
          trend: performanceTrend.trend,
          confidence: performanceTrend.confidence
        });

        if (performanceTrend.trend === 'declining') {
          analysis.riskFactors.push('Declining performance trend over recent evaluations');
          analysis.recommendations.push('Schedule performance improvement plan discussion');
        } else if (performanceTrend.trend === 'improving') {
          analysis.strengths.push('Consistent performance improvement');
        }
      }

      // Analyze training completion patterns
      const trainingAnalysis = this.analyzeTrainingPatterns(employeeData.training);
      analysis.insights.push({
        type: 'training_analysis',
        title: 'Learning &amp; Development Analysis',
        content: trainingAnalysis.summary,
        completionRate: trainingAnalysis.completionRate,
        avgTimeToComplete: trainingAnalysis.avgTimeToComplete
      });

      if (trainingAnalysis.completionRate &lt; 0.7) {
        analysis.riskFactors.push('Low training completion rate');
        analysis.recommendations.push('Review training assignments and provide additional support');
      }

      // Analyze tenure and engagement
      const tenureAnalysis = this.analyzeTenureAndEngagement(employeeData);
      analysis.insights.push(tenureAnalysis);

      // Use AI for advanced insights if available
      if (openai &amp;&amp; options.useAI) {
        const aiInsights = await this.generateAIInsights(employeeData);
        analysis.aiInsights = aiInsights;
      }

      return analysis;
    } catch (error) {
      console.error('Error analyzing employee performance:', error);
      throw error;
    }
  }

  /**
   * Predict employee turnover risk
   */
  static async predictTurnoverRisk(employeeId) {
    try {
      const employeeData = await this.getEmployeeAnalysisData(employeeId);
      
      if (!employeeData) {
        throw new Error('Employee not found');
      }

      let riskScore = 0;
      const riskFactors = [];
      const protectiveFactors = [];

      // Tenure factor
      const tenureMonths = this.calculateTenureMonths(employeeData.hire_date);
      if (tenureMonths &lt; 6) {
        riskScore += 30;
        riskFactors.push('New employee (&lt; 6 months tenure)');
      } else if (tenureMonths > 24) {
        riskScore -= 10;
        protectiveFactors.push('Established employee (> 2 years tenure)');
      }

      // Performance factor
      const recentPerformance = employeeData.evaluations
        .filter(evaluation => new Date(evaluation.evaluation_date) > new Date(Date.now() - 365 * 24 * 60 * 60 * 1000))
        .sort((a, b) => new Date(b.evaluation_date) - new Date(a.evaluation_date))[0];

      if (recentPerformance) {
        if (recentPerformance.overall_rating &lt;= 2) {
          riskScore += 25;
          riskFactors.push('Low performance rating');
        } else if (recentPerformance.overall_rating >= 4) {
          riskScore -= 15;
          protectiveFactors.push('High performance rating');
        }
      }

      // Training engagement factor
      const recentTraining = employeeData.training.filter(
        t => new Date(t.created_at) > new Date(Date.now() - 365 * 24 * 60 * 60 * 1000)
      );
      
      if (recentTraining.length === 0) {
        riskScore += 15;
        riskFactors.push('No recent training participation');
      } else {
        const completedTraining = recentTraining.filter(t => t.status === 'completed');
        const completionRate = completedTraining.length / recentTraining.length;
        
        if (completionRate &lt; 0.5) {
          riskScore += 20;
          riskFactors.push('Low training completion rate');
        } else if (completionRate > 0.8) {
          riskScore -= 10;
          protectiveFactors.push('High training engagement');
        }
      }

      // Manager relationship (if available)
      if (employeeData.manager_id) {
        protectiveFactors.push('Has assigned manager/mentor');
        riskScore -= 5;
      }

      // Salary competitiveness (simplified check)
      if (employeeData.base_salary &amp;&amp; employeeData.position_min_salary &amp;&amp; employeeData.position_max_salary) {
        const salaryRatio = (employeeData.base_salary - employeeData.position_min_salary) / 
                           (employeeData.position_max_salary - employeeData.position_min_salary);
        
        if (salaryRatio &lt; 0.3) {
          riskScore += 20;
          riskFactors.push('Below-market compensation');
        } else if (salaryRatio > 0.7) {
          riskScore -= 5;
          protectiveFactors.push('Competitive compensation');
        }
      }

      // Normalize risk score to 0-100 scale
      riskScore = Math.max(0, Math.min(100, riskScore + 50));

      let riskLevel;
      if (riskScore >= 80) riskLevel = 'Very High';
      else if (riskScore >= 65) riskLevel = 'High';
      else if (riskScore >= 45) riskLevel = 'Medium';
      else if (riskScore >= 25) riskLevel = 'Low';
      else riskLevel = 'Very Low';

      return {
        employeeId,
        riskScore,
        riskLevel,
        riskFactors,
        protectiveFactors,
        recommendations: this.generateRetentionRecommendations(riskLevel, riskFactors),
        analysisDate: new Date()
      };
    } catch (error) {
      console.error('Error predicting turnover risk:', error);
      throw error;
    }
  }

  /**
   * Analyze document usage patterns and provide insights
   */
  static async analyzeDocumentIntelligence(documentId) {
    try {
      const query = `
        SELECT 
          d.*,
          COUNT(da.id) as access_count,
          COUNT(DISTINCT da.user_id) as unique_users,
          COUNT(dack.id) as acknowledgment_count,
          AVG(EXTRACT(EPOCH FROM (da.accessed_at - d.created_at))/86400) as avg_days_to_access
        FROM documents d
        LEFT JOIN document_access da ON d.id = da.document_id
        LEFT JOIN document_acknowledgments dack ON d.id = dack.document_id
        WHERE d.id = $1
        GROUP BY d.id
      `;

      const result = await pool.query(query, [documentId]);
      
      if (result.rows.length === 0) {
        throw new Error('Document not found');
      }

      const docData = result.rows[0];
      const analysis = {
        documentId,
        analysisDate: new Date(),
        insights: []
      };

      // Usage analysis
      if (docData.access_count > 0) {
        analysis.insights.push({
          type: 'usage_statistics',
          title: 'Document Usage Analysis',
          accessCount: parseInt(docData.access_count),
          uniqueUsers: parseInt(docData.unique_users),
          acknowledgmentRate: docData.requires_acknowledgment ? 
            (parseInt(docData.acknowledgment_count) / parseInt(docData.unique_users) * 100) : null
        });

        // Engagement analysis
        const avgDaysToAccess = parseFloat(docData.avg_days_to_access);
        if (avgDaysToAccess > 30) {
          analysis.insights.push({
            type: 'engagement_concern',
            title: 'Low Engagement Alert',
            content: 'Document takes an average of ' + Math.round(avgDaysToAccess) + ' days to be accessed after creation'
          });
        }
      }

      // Category-based recommendations
      const categoryInsights = this.generateDocumentCategoryInsights(docData.category, docData);
      analysis.insights.push(...categoryInsights);

      return analysis;
    } catch (error) {
      console.error('Error analyzing document intelligence:', error);
      throw error;
    }
  }

  /**
   * Generate organizational health recommendations
   */
  static async generateHealthRecommendations(departmentId = null) {
    try {
      const recommendations = {
        immediate: [],
        shortTerm: [],
        longTerm: [],
        analysisDate: new Date()
      };

      // Get organizational metrics
      const metricsQuery = `
        SELECT 
          COUNT(DISTINCT e.id) as employee_count,
          AVG(ev.overall_rating) as avg_performance,
          COUNT(i.id) as incident_count,
          COUNT(ct.id) FILTER (WHERE ct.status != 'compliant') as compliance_issues,
          COUNT(ra.id) FILTER (WHERE ra.risk_level IN ('high', 'critical')) as high_risks
        FROM employees e
        LEFT JOIN employee_evaluations ev ON e.id = ev.employee_id 
          AND ev.evaluation_date >= CURRENT_DATE - INTERVAL '1 year'
        LEFT JOIN incidents i ON e.id = i.reported_by 
          AND i.incident_date >= CURRENT_DATE - INTERVAL '6 months'
        LEFT JOIN compliance_tracking ct ON e.department_id = ct.responsible_department
        LEFT JOIN risk_assessments ra ON e.department_id = ra.owner_department
        WHERE e.employment_status = 'active'
          ${departmentId ? 'AND e.department_id = $1' : ''}
      `;

      const metricsResult = await pool.query(
        metricsQuery, 
        departmentId ? [departmentId] : []
      );
      
      const metrics = metricsResult.rows[0];

      // Analyze and generate recommendations
      if (parseInt(metrics.compliance_issues) > 0) {
        recommendations.immediate.push({
          priority: 'high',
          title: 'Address Compliance Issues',
          description: `${metrics.compliance_issues} compliance items require immediate attention`,
          action: 'Review and resolve non-compliant items'
        });
      }

      if (parseInt(metrics.high_risks) > 0) {
        recommendations.immediate.push({
          priority: 'high',
          title: 'Mitigate High-Risk Items',
          description: `${metrics.high_risks} high or critical risk items identified`,
          action: 'Implement risk mitigation strategies'
        });
      }

      if (parseFloat(metrics.avg_performance) &lt; 3.0) {
        recommendations.shortTerm.push({
          priority: 'medium',
          title: 'Improve Performance Management',
          description: 'Average performance rating is below expectations',
          action: 'Implement performance improvement programs'
        });
      }

      if (parseInt(metrics.incident_count) > parseInt(metrics.employee_count) * 0.1) {
        recommendations.shortTerm.push({
          priority: 'medium',
          title: 'Reduce Incident Rate',
          description: 'High incident rate compared to employee count',
          action: 'Review safety procedures and training programs'
        });
      }

      // Long-term strategic recommendations
      recommendations.longTerm.push({
        priority: 'low',
        title: 'Implement Predictive Analytics',
        description: 'Use data-driven insights for proactive management',
        action: 'Establish regular analytics review cycles'
      });

      return recommendations;
    } catch (error) {
      console.error('Error generating health recommendations:', error);
      throw error;
    }
  }

  // Helper methods

  static async getEmployeeAnalysisData(employeeId) {
    const query = `
      SELECT 
        e.*,
        u.name as employee_name,
        u.email,
        d.name as department_name,
        jp.title as position_title,
        jp.min_salary as position_min_salary,
        jp.max_salary as position_max_salary,
        m.employee_id as manager_employee_id
      FROM employees e
      JOIN users u ON e.user_id = u.id
      JOIN departments d ON e.department_id = d.id
      JOIN job_positions jp ON e.position_id = jp.id
      LEFT JOIN employees m ON e.manager_id = m.id
      WHERE e.id = $1
    `;

    const employeeResult = await pool.query(query, [employeeId]);
    
    if (employeeResult.rows.length === 0) {
      return null;
    }

    const employee = employeeResult.rows[0];

    // Get evaluations
    const evaluationsQuery = `
      SELECT * FROM employee_evaluations
      WHERE employee_id = $1
      ORDER BY evaluation_date DESC
    `;
    const evaluationsResult = await pool.query(evaluationsQuery, [employeeId]);

    // Get training records
    const trainingQuery = `
      SELECT * FROM training_records
      WHERE employee_id = $1
      ORDER BY created_at DESC
    `;
    const trainingResult = await pool.query(trainingQuery, [employeeId]);

    return {
      ...employee,
      evaluations: evaluationsResult.rows,
      training: trainingResult.rows
    };
  }

  static analyzePerformanceTrend(evaluations) {
    if (evaluations.length &lt; 2) {
      return {
        trend: 'insufficient_data',
        summary: 'Not enough evaluation data to determine trend',
        confidence: 0
      };
    }

    const sortedEvals = evaluations.sort((a, b) => new Date(a.evaluation_date) - new Date(b.evaluation_date));
    const ratings = sortedEvals.map(e => e.overall_rating).filter(r => r !== null);
    
    if (ratings.length &lt; 2) {
      return {
        trend: 'insufficient_data',
        summary: 'No rating data available',
        confidence: 0
      };
    }

    // Simple linear trend analysis
    const firstHalf = ratings.slice(0, Math.ceil(ratings.length / 2));
    const secondHalf = ratings.slice(Math.floor(ratings.length / 2));
    
    const firstAvg = firstHalf.reduce((a, b) => a + b, 0) / firstHalf.length;
    const secondAvg = secondHalf.reduce((a, b) => a + b, 0) / secondHalf.length;
    
    const difference = secondAvg - firstAvg;
    const confidence = Math.min(1, ratings.length / 5); // Higher confidence with more data points

    let trend;
    if (difference > 0.5) {
      trend = 'improving';
    } else if (difference &lt; -0.5) {
      trend = 'declining';
    } else {
      trend = 'stable';
    }

    return {
      trend,
      summary: `Performance trend is ${trend} with a ${Math.abs(difference).toFixed(1)} point change`,
      confidence: Math.round(confidence * 100)
    };
  }

  static analyzeTrainingPatterns(trainingRecords) {
    const completedTraining = trainingRecords.filter(t => t.status === 'completed');
    const completionRate = trainingRecords.length > 0 ? completedTraining.length / trainingRecords.length : 0;
    
    // Calculate average time to complete
    const completionTimes = completedTraining
      .filter(t => t.completion_date &amp;&amp; t.created_at)
      .map(t => {
        const created = new Date(t.created_at);
        const completed = new Date(t.completion_date);
        return (completed - created) / (1000 * 60 * 60 * 24); // days
      });
    
    const avgTimeToComplete = completionTimes.length > 0 
      ? completionTimes.reduce((a, b) => a + b, 0) / completionTimes.length 
      : null;

    return {
      completionRate,
      avgTimeToComplete,
      summary: `Training completion rate: ${Math.round(completionRate * 100)}%${
        avgTimeToComplete ? `, average ${Math.round(avgTimeToComplete)} days to complete` : ''
      }`
    };
  }

  static analyzeTenureAndEngagement(employeeData) {
    const tenureMonths = this.calculateTenureMonths(employeeData.hire_date);
    const tenureYears = (tenureMonths / 12).toFixed(1);
    
    let engagementLevel;
    if (tenureMonths &lt; 6) {
      engagementLevel = 'new_employee';
    } else if (tenureMonths &lt; 24) {
      engagementLevel = 'developing';
    } else if (tenureMonths &lt; 60) {
      engagementLevel = 'established';
    } else {
      engagementLevel = 'senior';
    }

    return {
      type: 'tenure_analysis',
      title: 'Tenure &amp; Engagement Analysis',
      tenureMonths,
      tenureYears: parseFloat(tenureYears),
      engagementLevel,
      content: `Employee has ${tenureYears} years of tenure and is classified as ${engagementLevel}`
    };
  }

  static calculateTenureMonths(hireDate) {
    const hire = new Date(hireDate);
    const now = new Date();
    return Math.floor((now - hire) / (1000 * 60 * 60 * 24 * 30.44)); // Approximate months
  }

  static generateRetentionRecommendations(riskLevel, riskFactors) {
    const recommendations = [];

    if (riskLevel === 'Very High' || riskLevel === 'High') {
      recommendations.push('Schedule immediate one-on-one meeting to discuss career goals and concerns');
      recommendations.push('Review compensation and benefits package');
      recommendations.push('Consider providing additional development opportunities');
    }

    if (riskFactors.includes('Low performance rating')) {
      recommendations.push('Develop performance improvement plan with clear milestones');
      recommendations.push('Provide additional training and mentoring support');
    }

    if (riskFactors.includes('No recent training participation')) {
      recommendations.push('Enroll in relevant training programs');
      recommendations.push('Discuss career development goals and create learning plan');
    }

    if (riskFactors.includes('Below-market compensation')) {
      recommendations.push('Review salary against market rates');
      recommendations.push('Consider non-monetary benefits and recognition programs');
    }

    return recommendations;
  }

  static generateDocumentCategoryInsights(category, docData) {
    const insights = [];

    switch (category) {
      case 'policy':
        if (docData.requires_acknowledgment &amp;&amp; parseInt(docData.acknowledgment_count) &lt; parseInt(docData.unique_users) * 0.8) {
          insights.push({
            type: 'policy_compliance',
            title: 'Policy Acknowledgment Concern',
            content: 'Low acknowledgment rate may indicate compliance risk'
          });
        }
        break;
      
      case 'manual':
        if (parseInt(docData.access_count) &lt; 10) {
          insights.push({
            type: 'utilization',
            title: 'Low Utilization',
            content: 'Manual may need better promotion or may be outdated'
          });
        }
        break;
      
      case 'form':
        insights.push({
          type: 'process_efficiency',
          title: 'Form Usage Analysis',
          content: 'Consider digitizing frequently accessed forms for better efficiency'
        });
        break;
    }

    return insights;
  }

  static async generateAIInsights(employeeData) {
    if (!openai) {
      return null;
    }

    try {
      const prompt = `
        Analyze the following employee data and provide strategic HR insights:
        
        Employee: ${employeeData.employee_name}
        Department: ${employeeData.department_name}
        Position: ${employeeData.position_title}
        Tenure: ${this.calculateTenureMonths(employeeData.hire_date)} months
        
        Recent Performance Evaluations: ${JSON.stringify(employeeData.evaluations.slice(0, 3))}
        Training Records: ${JSON.stringify(employeeData.training.slice(0, 5))}
        
        Please provide:
        1. Key strengths and development areas
        2. Career progression recommendations
        3. Risk factors for retention
        4. Suggested development opportunities
        
        Respond in JSON format with categories: strengths, development_areas, career_recommendations, retention_risks, development_opportunities
      `;

      const response = await openai.chat.completions.create({
        model: 'deepseek-chat',
        messages: [{ role: 'user', content: prompt }],
        max_tokens: 1000,
        temperature: 0.3
      });

      const aiResponse = response.choices[0].message.content;
      return JSON.parse(aiResponse);
    } catch (error) {
      console.error('Error generating AI insights:', error);
      return null;
    }
  }
}

module.exports = OrganizationalAIService;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-routes_assignments.html">routes/assignments</a></li><li><a href="module-routes_games.html">routes/games</a></li></ul><h3>Classes</h3><ul><li><a href="AdvancedPerformanceMetrics.html">AdvancedPerformanceMetrics</a></li><li><a href="ApiError.html">ApiError</a></li><li><a href="AppError.html">AppError</a></li><li><a href="ApprovalWorkflowService.html">ApprovalWorkflowService</a></li><li><a href="AuthenticationError.html">AuthenticationError</a></li><li><a href="AuthorizationError.html">AuthorizationError</a></li><li><a href="global.html#BaseService">BaseService</a></li><li><a href="BudgetCalculationService.html">BudgetCalculationService</a></li><li><a href="BusinessLogicError.html">BusinessLogicError</a></li><li><a href="ConfigurationError.html">ConfigurationError</a></li><li><a href="ConflictError.html">ConflictError</a></li><li><a href="DatabaseError.html">DatabaseError</a></li><li><a href="DistanceCalculationService.html">DistanceCalculationService</a></li><li><a href="EncryptionService.html">EncryptionService</a></li><li><a href="ErrorFactory.html">ErrorFactory</a></li><li><a href="ErrorLogger.html">ErrorLogger</a></li><li><a href="ErrorMetrics.html">ErrorMetrics</a></li><li><a href="ErrorUtils.html">ErrorUtils</a></li><li><a href="ExternalServiceError.html">ExternalServiceError</a></li><li><a href="FileProcessingError.html">FileProcessingError</a></li><li><a href="FinancialAIService.html">FinancialAIService</a></li><li><a href="LocationDataService.html">LocationDataService</a></li><li><a href="MetricsCollector.html">MetricsCollector</a></li><li><a href="NotFoundError.html">NotFoundError</a></li><li><a href="PaymentMethodService.html">PaymentMethodService</a></li><li><a href="QueryBuilder.html">QueryBuilder</a></li><li><a href="QueryCache.html">QueryCache</a></li><li><a href="QueryPerformanceAnalyzer.html">QueryPerformanceAnalyzer</a></li><li><a href="RateLimitError.html">RateLimitError</a></li><li><a href="ResponseFormatter.html">ResponseFormatter</a></li><li><a href="SecurityService.html">SecurityService</a></li><li><a href="ServiceFactory.html">ServiceFactory</a></li><li><a href="TimeoutError.html">TimeoutError</a></li><li><a href="UnprocessableEntityError.html">UnprocessableEntityError</a></li><li><a href="ValidationError.html">ValidationError</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AUDIT_EVENTS">AUDIT_EVENTS</a></li><li><a href="global.html#AUDIT_SEVERITY">AUDIT_SEVERITY</a></li><li><a href="global.html#AssignmentSchemas">AssignmentSchemas</a></li><li><a href="global.html#AuthSchemas">AuthSchemas</a></li><li><a href="global.html#AvailabilitySchemas">AvailabilitySchemas</a></li><li><a href="global.html#BaseSchemas">BaseSchemas</a></li><li><a href="global.html#BudgetSchemas">BudgetSchemas</a></li><li><a href="global.html#COMMON_PATTERNS">COMMON_PATTERNS</a></li><li><a href="global.html#CUSTOM_VALIDATORS">CUSTOM_VALIDATORS</a></li><li><a href="global.html#CacheHelpers">CacheHelpers</a></li><li><a href="global.html#CacheInvalidation">CacheInvalidation</a></li><li><a href="global.html#ERROR_MESSAGES">ERROR_MESSAGES</a></li><li><a href="global.html#ERROR_SEVERITY">ERROR_SEVERITY</a></li><li><a href="global.html#ERROR_TYPES">ERROR_TYPES</a></li><li><a href="global.html#FileSchemas">FileSchemas</a></li><li><a href="global.html#FilterSchemas">FilterSchemas</a></li><li><a href="global.html#GameSchemas">GameSchemas</a></li><li><a href="global.html#HTTP_STATUS">HTTP_STATUS</a></li><li><a href="global.html#IdParamSchema">IdParamSchema</a></li><li><a href="global.html#NodeCache">NodeCache</a></li><li><a href="global.html#PaginationSchema">PaginationSchema</a></li><li><a href="global.html#QueryHelpers">QueryHelpers</a></li><li><a href="global.html#SCHEMA_REGISTRY">SCHEMA_REGISTRY</a></li><li><a href="global.html#UserSchemas">UserSchemas</a></li><li><a href="global.html#VALIDATION_OPTIONS">VALIDATION_OPTIONS</a></li><li><a href="global.html#addMinutes">addMinutes</a></li><li><a href="global.html#advancedPerformanceMonitor">advancedPerformanceMonitor</a></li><li><a href="global.html#asyncHandler">asyncHandler</a></li><li><a href="global.html#auditMiddleware">auditMiddleware</a></li><li><a href="global.html#authLimiter">authLimiter</a></li><li><a href="global.html#autoValidate">autoValidate</a></li><li><a href="global.html#calculateAvailabilityScore">calculateAvailabilityScore</a></li><li><a href="global.html#calculateDatabaseHealthScore">calculateDatabaseHealthScore</a></li><li><a href="global.html#calculateEndTime">calculateEndTime</a></li><li><a href="global.html#calculateFinalWage">calculateFinalWage</a></li><li><a href="global.html#checkAssignmentConflicts">checkAssignmentConflicts</a></li><li><a href="global.html#checkGameSchedulingConflicts">checkGameSchedulingConflicts</a></li><li><a href="global.html#checkRefereeDoubleBooking">checkRefereeDoubleBooking</a></li><li><a href="global.html#checkServiceHealth">checkServiceHealth</a></li><li><a href="global.html#checkTimeOverlap">checkTimeOverlap</a></li><li><a href="global.html#checkTravelTimeConflict">checkTravelTimeConflict</a></li><li><a href="global.html#checkVenueConflict">checkVenueConflict</a></li><li><a href="global.html#clearSettingsCache">clearSettingsCache</a></li><li><a href="global.html#conditionalValidation">conditionalValidation</a></li><li><a href="global.html#createAuditLog">createAuditLog</a></li><li><a href="global.html#createAuditLogsTable">createAuditLogsTable</a></li><li><a href="global.html#createPerformanceRoute">createPerformanceRoute</a></li><li><a href="global.html#createSecurityMiddleware">createSecurityMiddleware</a></li><li><a href="global.html#createTableService">createTableService</a></li><li><a href="global.html#createValidationError">createValidationError</a></li><li><a href="global.html#createValidator">createValidator</a></li><li><a href="global.html#db">db</a></li><li><a href="global.html#determineErrorSeverity">determineErrorSeverity</a></li><li><a href="global.html#determineEventType">determineEventType</a></li><li><a href="global.html#determineHealthStatus">determineHealthStatus</a></li><li><a href="global.html#determineIfShouldLog">determineIfShouldLog</a></li><li><a href="global.html#determineSeverity">determineSeverity</a></li><li><a href="global.html#enforceHTTPS">enforceHTTPS</a></li><li><a href="global.html#enhancedAsyncHandler">enhancedAsyncHandler</a></li><li><a href="global.html#errorHandler">errorHandler</a></li><li><a href="global.html#errorHealthCheck">errorHealthCheck</a></li><li><a href="global.html#express">express</a></li><li><a href="global.html#findAvailableReferees">findAvailableReferees</a></li><li><a href="global.html#formatAvailabilityResponse">formatAvailabilityResponse</a></li><li><a href="global.html#formatBytes">formatBytes</a></li><li><a href="global.html#generateAdvancedRecommendations">generateAdvancedRecommendations</a></li><li><a href="global.html#generateCacheRecommendations">generateCacheRecommendations</a></li><li><a href="global.html#generateDatabaseInsights">generateDatabaseInsights</a></li><li><a href="global.html#generateGroupStagePlayoffs">generateGroupStagePlayoffs</a></li><li><a href="global.html#generateHealthRecommendations">generateHealthRecommendations</a></li><li><a href="global.html#generateRecommendations">generateRecommendations</a></li><li><a href="global.html#generateRoundRobin">generateRoundRobin</a></li><li><a href="global.html#generateSingleElimination">generateSingleElimination</a></li><li><a href="global.html#generateSwissSystem">generateSwissSystem</a></li><li><a href="global.html#generateTransactionNumber">generateTransactionNumber</a></li><li><a href="global.html#getAdvancedMetrics">getAdvancedMetrics</a></li><li><a href="global.html#getAggregatedMetrics">getAggregatedMetrics</a></li><li><a href="global.html#getAuditEventType">getAuditEventType</a></li><li><a href="global.html#getClientIP">getClientIP</a></li><li><a href="global.html#getCorsConfig">getCorsConfig</a></li><li><a href="global.html#getErrorMessage">getErrorMessage</a></li><li><a href="global.html#getMetricsCollector">getMetricsCollector</a></li><li><a href="global.html#getMetricsEvents">getMetricsEvents</a></li><li><a href="global.html#getMetricsSummary">getMetricsSummary</a></li><li><a href="global.html#getMinutesBetween">getMinutesBetween</a></li><li><a href="global.html#getOrganizationSettings">getOrganizationSettings</a></li><li><a href="global.html#getPerformanceEvents">getPerformanceEvents</a></li><li><a href="global.html#getPerformanceStats">getPerformanceStats</a></li><li><a href="global.html#getQueryPerformanceEvents">getQueryPerformanceEvents</a></li><li><a href="global.html#getQueryPerformanceStats">getQueryPerformanceStats</a></li><li><a href="global.html#getSecurityConfig">getSecurityConfig</a></li><li><a href="global.html#getService">getService</a></li><li><a href="global.html#getServices">getServices</a></li><li><a href="global.html#getSlowQueriesSummary">getSlowQueriesSummary</a></li><li><a href="global.html#getWageBreakdown">getWageBreakdown</a></li><li><a href="global.html#handleApprovedRequest">handleApprovedRequest</a></li><li><a href="global.html#handleDatabaseError">handleDatabaseError</a></li><li><a href="global.html#hasSchedulingConflict">hasSchedulingConflict</a></li><li><a href="global.html#initializeServices">initializeServices</a></li><li><a href="global.html#knex">knex</a></li><li><a href="global.html#logError">logError</a></li><li><a href="global.html#logRequest">logRequest</a></li><li><a href="global.html#logSuspiciousActivity">logSuspiciousActivity</a></li><li><a href="global.html#logUnauthorizedCorsAttempt">logUnauthorizedCorsAttempt</a></li><li><a href="global.html#metricsEvents">metricsEvents</a></li><li><a href="global.html#notFoundHandler">notFoundHandler</a></li><li><a href="global.html#parseSize">parseSize</a></li><li><a href="global.html#parseSqlQuery">parseSqlQuery</a></li><li><a href="global.html#performanceEvents">performanceEvents</a></li><li><a href="global.html#performanceMonitor">performanceMonitor</a></li><li><a href="global.html#queryAuditLogs">queryAuditLogs</a></li><li><a href="global.html#queryCache">queryCache</a></li><li><a href="global.html#queryPerformanceEvents">queryPerformanceEvents</a></li><li><a href="global.html#queryValidationSchemas">queryValidationSchemas</a></li><li><a href="global.html#requestContextMiddleware">requestContextMiddleware</a></li><li><a href="global.html#requestContexts">requestContexts</a></li><li><a href="global.html#requestSizeLimit">requestSizeLimit</a></li><li><a href="global.html#resetAdvancedMetrics">resetAdvancedMetrics</a></li><li><a href="global.html#resetAllMetrics">resetAllMetrics</a></li><li><a href="global.html#resetPerformanceStats">resetPerformanceStats</a></li><li><a href="global.html#resetQueryPerformanceStats">resetQueryPerformanceStats</a></li><li><a href="global.html#sanitizeAll">sanitizeAll</a></li><li><a href="global.html#sanitizeBody">sanitizeBody</a></li><li><a href="global.html#sanitizeBodyForLogging">sanitizeBodyForLogging</a></li><li><a href="global.html#sanitizeError">sanitizeError</a></li><li><a href="global.html#sanitizeHeaders">sanitizeHeaders</a></li><li><a href="global.html#sanitizeInput">sanitizeInput</a></li><li><a href="global.html#sanitizeObject">sanitizeObject</a></li><li><a href="global.html#sanitizeParams">sanitizeParams</a></li><li><a href="global.html#sanitizeQuery">sanitizeQuery</a></li><li><a href="global.html#sanitizeString">sanitizeString</a></li><li><a href="global.html#securityConfig">securityConfig</a></li><li><a href="global.html#securityMonitoring">securityMonitoring</a></li><li><a href="global.html#sendAlertToWebhook">sendAlertToWebhook</a></li><li><a href="global.html#setupAlertHandlers">setupAlertHandlers</a></li><li><a href="global.html#setupGlobalErrorHandlers">setupGlobalErrorHandlers</a></li><li><a href="global.html#subtractMinutes">subtractMinutes</a></li><li><a href="global.html#testIntegrationConnection">testIntegrationConnection</a></li><li><a href="global.html#trackCacheOperation">trackCacheOperation</a></li><li><a href="global.html#trackDbQuery">trackDbQuery</a></li><li><a href="global.html#updateMetricsConfig">updateMetricsConfig</a></li><li><a href="global.html#validateAvailabilityWindow">validateAvailabilityWindow</a></li><li><a href="global.html#validateBody">validateBody</a></li><li><a href="global.html#validateContentType">validateContentType</a></li><li><a href="global.html#validateEnvironment">validateEnvironment</a></li><li><a href="global.html#validateFile">validateFile</a></li><li><a href="global.html#validateIdParam">validateIdParam</a></li><li><a href="global.html#validateParams">validateParams</a></li><li><a href="global.html#validateQuery">validateQuery</a></li><li><a href="global.html#validateRefereeQualifications">validateRefereeQualifications</a></li><li><a href="global.html#validateRequest">validateRequest</a></li><li><a href="global.html#validateUuidParam">validateUuidParam</a></li><li><a href="global.html#validationSummary">validationSummary</a></li><li><a href="global.html#withDatabaseError">withDatabaseError</a></li><li><a href="global.html#withErrorBoundary">withErrorBoundary</a></li><li><a href="global.html#withServiceTransaction">withServiceTransaction</a></li><li><a href="global.html#wrapDatabaseConnection">wrapDatabaseConnection</a></li><li><a href="global.html#wrapDatabaseQuery">wrapDatabaseQuery</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Fri Aug 01 2025 16:15:52 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
