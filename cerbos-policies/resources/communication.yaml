---
apiVersion: api.cerbos.dev/v1
description: Policy for communication resource
resourcePolicy:
  version: "default"
  importDerivedRoles:
    - common_roles
  resource: "communication"
  rules:
    - actions: ['view:list', 'view:details', 'create', 'update', 'publish', 'archive', 'admin:view_recipients', 'admin:view_stats']
      effect: EFFECT_ALLOW
      roles:
        - admin
      derivedRoles:
        - organization_admin

    - actions: ['view:list', 'view:details', 'acknowledge', 'view:unread_count', 'view:pending_acknowledgments']
      effect: EFFECT_ALLOW
      roles:
        - assignor
        - referee

    - actions: ['*']
      effect: EFFECT_DENY
      roles:
        - guest